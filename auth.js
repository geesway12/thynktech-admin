import{db,saveDb}from"./db.js";import{wrapWithLayout}from"./layout.js";import*as exportUtils from"./export.js";export function renderLogin(n){n.innerHTML='\n    <style>\n      .thynktech-login-container {\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        min-height: 100vh;\n        background: linear-gradient(135deg, #ffd700 0%, #ffaa00 25%, #2196f3 50%, #eaf6fb 100%);\n        background-size: 400% 400%;\n        animation: gradientShift 8s ease infinite;\n      }\n      \n      @keyframes gradientShift {\n        0% { background-position: 0% 50%; }\n        50% { background-position: 100% 50%; }\n        100% { background-position: 0% 50%; }\n      }\n      \n      .thynktech-login-card {\n        background: rgba(255, 255, 255, 0.95);\n        border-radius: 20px;\n        box-shadow: 0 20px 40px rgba(33, 150, 243, 0.15), 0 10px 20px rgba(255, 215, 0, 0.1);\n        padding: 2.5rem 2rem;\n        width: 100%;\n        max-width: 420px;\n        backdrop-filter: blur(10px);\n        border: 1px solid rgba(255, 255, 255, 0.2);\n      }\n      \n      .thynktech-login-header {\n        text-align: center;\n        margin-bottom: 2rem;\n      }\n      \n      .thynktech-login-header h1 {\n        color: #2196f3;\n        font-size: 1.75rem;\n        font-weight: 700;\n        margin: 0.5rem 0 0.25rem;\n        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);\n      }\n      \n      .thynktech-login-header p {\n        color: #666;\n        font-size: 0.95rem;\n        margin: 0;\n        font-weight: 400;\n      }\n      \n      .form-blue-label {\n        color: #2196f3;\n        font-weight: 600;\n        margin-bottom: 0.4rem;\n        display: block;\n      }\n      \n      .form-blue-input {\n        width: 100%;\n        padding: 0.85rem 1rem;\n        border: 2px solid #e3f2fd;\n        border-radius: 10px;\n        background: rgba(255, 255, 255, 0.9);\n        font-size: 1rem;\n        margin-bottom: 1.2rem;\n        transition: all 0.3s ease;\n        color: #222;\n      }\n      \n      .form-blue-input:focus {\n        border-color: #2196f3;\n        outline: none;\n        box-shadow: 0 0 0 3px rgba(33, 150, 243, 0.1);\n      }\n      \n      .form-blue-btn-main {\n        width: 100%;\n        background: linear-gradient(90deg, #ffd700, #2196f3);\n        color: #fff;\n        border: none;\n        border-radius: 10px;\n        padding: 0.9rem;\n        font-weight: 600;\n        font-size: 1.1rem;\n        margin-top: 1.2rem;\n        cursor: pointer;\n        transition: all 0.3s ease;\n        text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);\n      }\n      \n      .form-blue-btn-main:hover {\n        background: linear-gradient(90deg, #2196f3, #ffd700);\n        transform: translateY(-2px);\n        box-shadow: 0 5px 15px rgba(33, 150, 243, 0.3);\n      }\n      \n      .thynktech-import-section {\n        border-top: 1px solid #e3f2fd;\n        padding-top: 1.5rem;\n        margin-top: 1rem;\n      }\n      \n      .thynktech-btn-import {\n        width: 100%;\n        padding: 0.75rem;\n        background: linear-gradient(45deg, #e3f2fd, #b3e0fc);\n        border: none;\n        border-radius: 12px;\n        color: #2196f3;\n        font-weight: 600;\n        font-size: 0.95rem;\n        transition: all 0.3s ease;\n        cursor: pointer;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        gap: 8px;\n      }\n      \n      .thynktech-btn-import:hover {\n        background: linear-gradient(45deg, #b3e0fc, #81d4fa);\n        transform: translateY(-1px);\n      }\n      \n      .thynktech-error-message {\n        background: rgba(220, 53, 69, 0.1);\n        border: 1px solid rgba(220, 53, 69, 0.3);\n        color: #dc3545;\n        padding: 0.75rem;\n        border-radius: 8px;\n        margin-top: 1rem;\n        font-size: 0.9rem;\n      }\n      \n      .thynktech-success-message {\n        background: rgba(25, 135, 84, 0.1);\n        border: 1px solid rgba(25, 135, 84, 0.3);\n        color: #198754;\n        padding: 0.75rem;\n        border-radius: 8px;\n        margin-top: 1rem;\n        font-size: 0.9rem;\n      }\n      \n      @media (max-width: 768px) {\n        .thynktech-login-container {\n          padding: 1rem;\n        }\n        .thynktech-login-card {\n          padding: 2rem 1.5rem;\n        }\n      }\n    </style>\n    \n    <div class="thynktech-login-container">\n      <div class="thynktech-login-card">\n        <div class="thynktech-login-header">\n          <h1>üá¨üá≠ ThynkTech Login</h1>\n          <p>Sign in to start managing healthcare responsibly</p>\n        </div>\n        \n        <form id="loginForm">\n          <label class="form-blue-label" for="username">Email Address</label>\n          <input type="text" id="username" name="username" class="form-blue-input" required autocomplete="username">\n          \n          <label class="form-blue-label" for="password">Password</label>\n          <input type="password" id="password" name="password" class="form-blue-input" required autocomplete="current-password">\n          \n          <button type="submit" class="form-blue-btn-main">Login</button>\n        </form>\n        \n        <div class="thynktech-import-section" id="importSection" style="display: none;">\n          <button type="button" class="thynktech-btn-import" onclick="showImportOptions()">\n            üîß Member Data Import Setup\n          </button>\n        </div>\n        \n        <div id="loginMessage"></div>\n      </div>\n    </div>\n  ';const e=!(window.location.pathname.includes("/admin/")||window.location.href.includes("/admin/")||document.title.includes("Admin"));document.getElementById("loginForm").onsubmit=function(n){n.preventDefault();const e=this.username.value.trim(),t=this.password.value,r=db.users.find(n=>n.username===e&&n.password===t);if(r)db.currentUser=r,saveDb(),r.role&&"admin"===r.role.toLowerCase()?window.location.hash="#admin-dashboard":window.location.hash="#user-dashboard";else{const n=document.getElementById("loginMessage");n.innerHTML='<div class="thynktech-error-message">Invalid username or password! Please check your credentials.</div>',setTimeout(()=>{n.innerHTML=""},5e3)}},e&&(document.getElementById("importSection").style.display="block"),window.showImportOptions=function(){if(!e)return;const n=document.createElement("input");n.type="file",n.accept="application/json",n.onchange=function(n){const e=n.target.files[0];if(!e)return;const t=new FileReader;t.onload=function(n){try{const e=JSON.parse(n.target.result);if(!e.users||!e.registers)throw new Error("Invalid setup file");db.facility=e.facility||{},db.settings=e.settings||{},db.users=e.users||[],db.registers=e.registers||[],db.roles=e.roles||[],db.servicesList=e.servicesList||[],db.customPatientFields=e.customPatientFields||[],saveDb();document.getElementById("loginMessage").innerHTML='<div class="thynktech-success-message">‚úÖ Setup imported successfully! You can now log in with your credentials.</div>'}catch(n){document.getElementById("loginMessage").innerHTML='<div class="thynktech-error-message">‚ùå Import failed: Invalid or corrupted setup file.</div>'}},t.readAsText(e)},n.click()}}