import{db}from"./db.js";function loadChartJs(s){if(window.Chart)return s();const e=document.createElement("script");e.src="https://cdn.jsdelivr.net/npm/chart.js",e.onload=s,document.head.appendChild(e)}export function renderReports(s){s.innerHTML=`\n    <div class="container my-4">\n      <div class="d-flex justify-content-between align-items-center mb-3">\n        <h4><i class="bi bi-bar-chart"></i> Reports</h4>\n      </div>\n      <div class="row g-3">\n        <div class="col-md-3">\n          <div class="card shadow-sm text-center">\n            <div class="card-body">\n              <i class="bi bi-people fs-1 text-primary"></i>\n              <h6>Total Patients</h6>\n              <p class="fs-5" id="patientCount">${db.patients.length}</p>\n            </div>\n          </div>\n        </div>\n        <div class="col-md-3">\n          <div class="card shadow-sm text-center">\n            <div class="card-body">\n              <i class="bi bi-calendar-check fs-1 text-success"></i>\n              <h6>Total Visits</h6>\n              <p class="fs-5" id="visitCount">${db.visits.length}</p>\n            </div>\n          </div>\n        </div>\n        <div class="col-md-3">\n          <div class="card shadow-sm text-center">\n            <div class="card-body">\n              <i class="bi bi-clock-history fs-1 text-danger"></i>\n              <h6>Total Appointments</h6>\n              <p class="fs-5" id="appointmentCount">${db.appointments.length}</p>\n            </div>\n          </div>\n        </div>\n        <div class="col-md-3">\n          <div class="card shadow-sm text-center">\n            <div class="card-body">\n              <i class="bi bi-person-lines-fill fs-1 text-info"></i>\n              <h6>Total Users</h6>\n              <p class="fs-5" id="userCount">${db.users.length}</p>\n            </div>\n          </div>\n        </div>\n      </div>\n      <div class="row g-3 mt-3">\n        <div class="col-md-6">\n          <div class="card shadow-sm">\n            <div class="card-body">\n              <h6>Patients by Sex</h6>\n              <canvas id="sexPie" height="200"></canvas>\n            </div>\n          </div>\n        </div>\n        <div class="col-md-6">\n          <div class="card shadow-sm">\n            <div class="card-body">\n              <h6>Visits Trend</h6>\n              <canvas id="visitTrend" height="200"></canvas>\n            </div>\n          </div>\n        </div>\n      </div>\n      <div class="row g-3 mt-3">\n        <div class="col-md-12">\n          <div class="card shadow-sm">\n            <div class="card-body">\n              <h6>Services Offered per Register</h6>\n              <canvas id="servicesPerRegister" height="200"></canvas>\n            </div>\n          </div>\n        </div>\n      </div>\n      <a href="#admin-dashboard" class="btn btn-link mt-3"><i class="bi bi-arrow-left"></i> Back</a>\n    </div>\n  `;const e=db.registers.map(s=>({register:s.name,services:db.visits.filter(e=>e.registerId===s.id).reduce((s,e)=>s+(e.serviceType?.length||0),0)})),n=db.appointments.reduce((s,e)=>(s[e.status]=(s[e.status]||0)+1,s),{});console.log("Services per Register:",e),console.log("Appointments by Status:",n),loadChartJs(()=>{const s=[db.patients.filter(s=>"M"===s.sex).length,db.patients.filter(s=>"F"===s.sex).length,db.patients.filter(s=>"O"===s.sex).length];new Chart(document.getElementById("sexPie"),{type:"pie",data:{labels:["Male","Female","Other"],datasets:[{data:s,backgroundColor:["#0d6efd","#e83e8c","#6c757d"]}]},options:{responsive:!0}});const e=db.registers.map(s=>s.name),n=db.registers.map(s=>db.visits.filter(e=>e.registerId===s.id).length);new Chart(document.getElementById("servicesPerRegister"),{type:"bar",data:{labels:e,datasets:[{label:"Services Offered",data:n,backgroundColor:"#0dcaf0"}]},options:{responsive:!0,plugins:{legend:{display:!1}}}});const t=[],i=new Date;for(let s=11;s>=0;s--){const e=new Date(i.getFullYear(),i.getMonth()-s,1);t.push(`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}`)}const d=t.map(s=>db.visits.filter(e=>(e.visitDate||"").slice(0,7)===s).length);new Chart(document.getElementById("visitTrend"),{type:"line",data:{labels:t,datasets:[{label:"Visits",data:d,borderColor:"#198754",backgroundColor:"rgba(25,135,84,0.2)",fill:!0}]},options:{responsive:!0}})})}