const CACHE_NAME="afyacare-cache-v3",urlsToCache=["/","/index.html","/offline.html","/styles.css","/favicon.ico","/logo.png","/manifest.json","/app.js","/admin.js","/auth.js","/appointments.js","/backup.js","/db.js","/export.js","/formUtils.js","/idUtils.js","/patients.js","/pwa.js","/reports.js","/services.js","/utils.js","/visits.js"];function broadcastMessage(e){self.clients.matchAll().then(s=>{s.forEach(s=>s.postMessage(e))})}self.addEventListener("install",e=>{self.skipWaiting(),e.waitUntil(caches.open(CACHE_NAME).then(e=>e.addAll(urlsToCache)))}),self.addEventListener("activate",e=>{e.waitUntil(caches.keys().then(e=>Promise.all(e.filter(e=>e!==CACHE_NAME).map(e=>caches.delete(e))))),self.clients.claim()}),self.addEventListener("fetch",e=>{"GET"===e.request.method&&e.respondWith(caches.match(e.request).then(s=>s||fetch(e.request)).catch(()=>caches.match("/offline.html")))}),self.addEventListener("message",e=>{"checkForUpdate"===e.data&&self.skipWaiting()}),self.addEventListener("beforeinstallprompt",e=>{e.preventDefault(),self.installPrompt=e,self.clients.matchAll().then(e=>{e.forEach(e=>e.postMessage({type:"installPromptAvailable"}))})}),self.addEventListener("sync",()=>{broadcastMessage({type:"syncEvent"})});