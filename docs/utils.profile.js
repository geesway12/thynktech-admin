export function renderProfile(e,s){const{dashboardHash:a="#dashboard",getUser:n,updateUser:t,fieldLabels:l={}}=s,r=n();if(!r)return void(e.innerHTML='<div class="alert alert-danger">No user logged in.</div>');const o=l.username||"Username",i=l.fullName||"Full Name",d=l.contact||"Contact",c=l.currentPassword||"Current Password",u=l.newPassword||"New Password";e.innerHTML=`\n    <div class="container my-4">\n      <div class="card shadow mx-auto" style="max-width:400px;">\n        <div class="card-body">\n          <h4 class="mb-3"><i class="bi bi-person-circle"></i> Update Profile</h4>\n          <form id="profileForm" autocomplete="off">\n            <div class="mb-3">\n              <label class="form-label">${o}</label>\n              <input class="form-control" value="${r.username}" readonly>\n            </div>\n            <div class="mb-3">\n              <label class="form-label">${i}</label>\n              <input class="form-control" id="fullName" value="${r.fullName||r.name||""}" placeholder="${i}" required>\n            </div>\n            <div class="mb-3">\n              <label class="form-label">${d}</label>\n              <input class="form-control" id="contact" value="${r.contact||r.phone||""}" placeholder="${d}">\n            </div>\n            <hr>\n            <h6>Change Password</h6>\n            <div class="mb-2">\n              <label class="form-label">${c}</label>\n              <input type="password" class="form-control" id="currentPassword" autocomplete="current-password">\n            </div>\n            <div class="mb-2">\n              <label class="form-label">${u}</label>\n              <input type="password" class="form-control" id="newPassword" autocomplete="new-password">\n            </div>\n            <div class="d-flex justify-content-between mt-3">\n              <button class="btn btn-primary">Save Changes</button>\n              <a href="${a}" class="btn btn-secondary">Cancel</a>\n            </div>\n            <div id="profileMsg" class="mt-2 small"></div>\n          </form>\n        </div>\n      </div>\n    </div>\n  `,document.getElementById("profileForm").onsubmit=function(e){e.preventDefault();const s=this.fullName.value.trim(),n=this.contact.value.trim(),l=this.currentPassword.value,o=this.newPassword.value;let i="";if("fullName"in r&&(r.fullName=s),"name"in r&&(r.name=s),"contact"in r&&(r.contact=n),"phone"in r&&(r.phone=n),l||o){if(!l||!o)return i="Both current and new password are required to change password.",this.querySelector("#profileMsg").textContent=i,void(this.querySelector("#profileMsg").className="text-danger mt-2 small");if(r.password!==l)return i="Current password is incorrect.",this.querySelector("#profileMsg").textContent=i,void(this.querySelector("#profileMsg").className="text-danger mt-2 small");r.password=o,r.lastPasswordChange=Date.now(),i="Password updated! "}t(r),this.querySelector("#profileMsg").textContent=i+"Profile updated!",this.querySelector("#profileMsg").className="text-success mt-2 small",setTimeout(()=>{window.location.hash=a},1200)}}export function isPasswordExpired(e){if(!e)return!1;const s=e.lastPasswordChange||0;return(Date.now()-s)/864e5>30}